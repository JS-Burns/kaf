import urllib
import urllib2
import getpass
import platform
import sys
import os
import re
import httplib
import requests

OS = platform.system()
user = getpass.getuser()

def scan(url, description):
    try:
        request = requests.get("http://"+target+url)
        url_to_check = request.url
        response = requests.get(url_to_check)
        if response.status_code == 200 and not "404" in response.content and response.content != "":
            print "[+] Found: " + url_to_check
            print "[INFO] " + description
    except:
        pass

def open_file():
    try:
        os.chdir("check")
    except:
        print "I cannot find folder check. Sorry I cannot continue :-("
        sys.exit(2)
        
    try:
        file_to_check = open("vulns.txt", "r").readlines()
    except:
        print "An error has occured while trying to open vulns.txt . Sorry I cannot continue :-("
        sys.exit(2)
        
    for line in file_to_check:
        line = line.split("[")
        url = line[0]
        description = line[1]
        description = description.replace("]", "")
        scan(url, description)

def test_connection():
    try:
        urllib2.urlopen("http://"+target)
    except:
        print "Could not connect to", target + " . Sorry I cannot continue :-("
        sys.exit(2)

def banner():
    print"""
---------------------------------
|Vulnerability scanner by c3nt3rX |
|       KickAss Framework         |
--------------------------------
"""


banner()
target = raw_input("TARGET (e.g. surfwatchlabs.com) > ")
print "\n"
test_connection()
open_file()
